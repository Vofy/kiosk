#!/bin/sh
#
# ~/.xinitrc
#
# Executed by startx (run your window manager from here)

xset s noblank
xset s off
xset -dpms

while true; do
killall -TERM chromium-browser 2>/dev/null;
killall -TERM matchbox-window-manager 2>/dev/null;
sleep 2;
killall -9 chromium-browser 2>/dev/null;
killall -9 matchbox-window-manager 2>/dev/null;

unclutter -idle 0.5 -root &

sed -i 's/"exited_cleanly":false/"exited_cleanly":true/' /home/pi/.config/chromium/Default/Preferences
sed -i 's/"exit_type":"Crashed"/"exit_type":"Normal"/' /home/pi/.config/chromium/Default/Preferences
rm /home/pi/.config/chromium/SingletonLock

exec matchbox-window-manager -use_titlebar no &

/usr/bin/chromium-browser --incognito --kiosk --noerrdialogs --disable-default-apps --disable-single-click-autofill --disable-translate-new-ux --disable-translate --disable-infobars https://10.1.190.2:7070/
done
